---
title: AppliesTo Toolbox
description: Test and validate AppliesTo expressions with instant feedback.
---

import { Steps, Tabs, TabItem, Aside, Badge, LinkCard } from '@astrojs/starlight/components';
import { Icon } from '@astrojs/starlight/components';
import StatusBadge from '../../../components/StatusBadge.astro';

The AppliesTo Toolbox helps you build and test AppliesTo expressions before applying them to LogicModules. See exactly which resources match your expression.

## Opening the Toolbox

| Method | Action |
|--------|--------|
| **Welcome Screen** | Click **AppliesTo Toolbox** on the welcome screen |
| **Keyboard Shortcut** | Press <kbd>Cmd</kbd>+<kbd>K</kbd>, <kbd>A</kbd> to open directly |
| **Module Details** | Click the AppliesTo field when editing module details |

---

## Interface Overview

<img src="/lmda-composer/portal-tools/appliesto-interface.png" alt="AppliesTo Toolbox with expression editor and matching resources" style="border-radius: 0.5rem; margin: 1.5rem 0;" />

### Expression Editor

The main text area for writing AppliesTo expressions:

- Multi-line support for complex expressions
- Parenthesis matching and highlighting
- Real-time syntax hints
- Undo/redo support

### Quick Insert Bar

Buttons for common operators:

<div style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin: 1rem 0;">
  <Badge text="&&" variant="note" />
  <Badge text="||" variant="note" />
  <Badge text="!" variant="note" />
  <Badge text="( )" variant="note" />
  <Badge text="==" variant="note" />
  <Badge text="!=" variant="note" />
  <Badge text="=~" variant="note" />
  <Badge text="!~" variant="note" />
  <Badge text=">" variant="note" />
  <Badge text=">=" variant="note" />
  <Badge text="<" variant="note" />
  <Badge text="<=" variant="note" />
</div>

| Operator | Usage |
|----------|-------|
| `&&` or `and` | Logical AND — both conditions must match |
| `\|\|` or `or` | Logical OR — either condition matches |
| `!` or `not` | Logical NOT — negates the condition |
| `()` | Grouping — control operator precedence |
| `==` | Equals — exact value match |
| `!=` | Not equals — value doesn't match |
| `=~` | Regex match — pattern matching (case insensitive) |
| `!~` | Regex not match — pattern doesn't match |
| `>`, `>=`, `<`, `<=` | Comparison — numeric comparisons |

### Test Button

Click **Test AppliesTo** to evaluate the expression against all resources in your portal.

---

## Building Expressions

### Basic Property Match

Match devices with a specific property value:

```groovy
system.displayname == "web-server-01"
```

### Wildcard Matching

Use `=~` for pattern matching with regex:

```groovy
system.displayname =~ "web-.*"
```

### Multiple Conditions

Combine with AND/OR:

```groovy
// Devices that are Linux AND in Production
system.sysinfo =~ "Linux" && system.staticgroups =~ "Production"

// Devices that are either routers or switches
system.sysoid =~ "1.3.6.1.4.1.9" || system.categories =~ "switch"
```

### Grouping

Use parentheses for complex logic:

```groovy
(system.sysinfo =~ "Linux" || system.sysinfo =~ "Windows") 
&& system.staticgroups =~ "Monitored"
```

### Function Calls

Use built-in and custom functions:

```groovy
hasCategory("Windows") && !hasCategory("test")
```

---

## Function Reference

Click **Function Reference** to expand the available functions panel.

<Tabs>
  <TabItem label="Built-in Functions" icon="star">
    Functions are organized by category:

    | Category | Functions |
    |----------|-----------|
    | **Basic** | `true()`, `false()` |
    | **Properties** | `exists()`, `getPropValue()`, `getCollectorVersion()` |
    | **Categories** | `hasCategory()` |
    | **Arrays** | `contains()`, `join()` |
    | **Strings** | `startsWith()` |
    | **Math** | `sum()` |
    | **Device Types** | `isDevice()`, `isCollectorDevice()` |
    | **Cloud Services** | `isAWSService()`, `isAzureService()`, `isGCPService()` |
    | **Operating Systems** | `isWindows()`, `isLinux()`, `isUnix()`, `isSolaris()`, `isFreebsd()` |
    | **Infrastructure** | `isNetwork()`, `isStorage()`, `isVirtualization()`, `isMisc()` |
    | **Vendors** | `isCisco()`, `isF5()`, `isNetApp()`, `isNetscaler()`, `isArubaSwitch()` |
    | **Features** | `isNetflow()`, `isK8sPod()` |

    Click any function in the reference panel to see its syntax, parameters, and examples.
  </TabItem>
  
  <TabItem label="Custom Functions" icon="setting">
    Custom AppliesTo functions are reusable expressions defined in your portal:

    ```groovy
    // Instead of:
    system.sysinfo =~ "Linux" && hasCategory("server") && system.staticgroups =~ "Production"

    // Use a custom function:
    isLinuxProductionServer()
    ```

    ### Creating Custom Functions

    1. Write your expression in the toolbox
    2. Click **Save as Function**
    3. Enter a function name (e.g., `isLinuxProductionServer`)
    4. Add a description
    5. Click **Save**

    The function is saved to your LogicMonitor portal and available immediately.

    ### Filtering Functions

    Use the **Show only custom** toggle to filter the function list to show only your custom functions, hiding the built-in ones.
  </TabItem>
</Tabs>

### Inserting Functions

<Steps>

1. Find the function in the reference panel

2. Click the **Insert** button next to it

3. Function is added at cursor position

4. Fill in the arguments

</Steps>

---

## Custom Functions

### Managing Custom Functions

- **Edit Function** — Find the function → Click **Load** → Modify expression → Click **Update Function**
- **Delete Function** — Find the function → Click delete icon → Confirm deletion

<Aside type="caution" title="Dependency Check">
  Before deleting, verify no modules depend on the function. LogicModules using a deleted function will fail to evaluate.
</Aside>

---

## Testing Results

### Results Display

After clicking **Test AppliesTo**, results show matching resources:

| Column | Description |
|--------|-------------|
| ID | Resource ID |
| Type | Device, Service, etc. |
| Name | Display name |
| Hostname | System hostname (devices only) |

### Match Count

The header shows total matches: **"15 resources match"**

### Result States

| State | Description |
|-------|-------------|
| <StatusBadge status="success" label="Matches Found" /> | Resources matching your expression are listed |
| <StatusBadge status="warning" label="No Matches" /> | Expression is valid but no resources match |
| <StatusBadge status="error" label="Syntax Error" /> | Expression has errors (see error display) |

---

## Expression Syntax Errors

### Error Display

Invalid expressions show an error message:
- Red error banner
- Description of the issue
- Approximate location hint

### Common Errors

| Error | Cause | Fix |
|-------|-------|-----|
| Unexpected token | Missing operator | Add `&&` or `\|\|` between conditions |
| Unclosed string | Missing quote | Close all string literals |
| Unknown function | Typo in function name | Check spelling in reference |
| Invalid regex | Bad regex pattern | Validate regex syntax |

---

## Autocomplete

The editor provides autocomplete suggestions:

### Property Names

Start typing a property name to see suggestions:
- `system.` shows system properties
- `auto.` shows auto-properties
- Custom property prefixes

### Functions

Type the start of a function name to see matching functions.

### Activating Autocomplete

Autocomplete activates automatically, or press <kbd>Ctrl</kbd>+<kbd>Space</kbd> to trigger manually.

---

## Best Practices

- **Start Simple** — Begin with a single condition. Verify it matches expected resources. Add conditions one at a time, testing after each addition.
- **Use Parentheses** — Complex expressions benefit from explicit grouping: `(A && B) || C` is clearer than `A && B || C`.
- **Test Edge Cases** — Verify resources that should match do, and resources that shouldn't don't. Check boundary conditions.
- **Document Logic** — Use the description field for custom functions to explain the logic for future reference.

---

## Integration with Module Details

When editing module details:

<Steps>

1. Click the **AppliesTo** field in the module details editor

2. The toolbox opens with the current expression pre-loaded

3. Modify and test your expression

4. Save to update the module's AppliesTo

</Steps>

---

## Next Steps

<LinkCard
  title="Debug Commands"
  description="Run collector debug commands and health checks from LMDA Composer."
  href="/lmda-composer/portal-tools/debug-commands/"
/>
